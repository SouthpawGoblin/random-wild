(this["webpackJsonprandom-wild"]=this["webpackJsonprandom-wild"]||[]).push([[0],{13:function(t,e,i){},16:function(t,e,i){"use strict";i.r(e);var n=i(0),o=i.n(n),s=i(4),a=i.n(s),r=(i(13),i(7)),h=i(5),l=i.n(h),c=o.a.forwardRef((function(t,e){return o.a.createElement("canvas",{width:t.width,height:t.height,ref:e})})),d=i(6),u=i.n(d),v=i(1),g=i(2),f=function(){function t(){Object(v.a)(this,t),this.tiles=void 0,this.tiles={}}return Object(g.a)(t,[{key:"getTiles",value:function(){return this.tiles}},{key:"addTile",value:function(t){var e="".concat(t.position.x,"_").concat(t.position.y,"_").concat(t.position.z);this.tiles[e]=t}}]),t}(),_=function t(e,i){Object(v.a)(this,t),this.position=void 0,this.color=void 0,this.position=e,this.color=i},x=function(){function t(e,i,n){Object(v.a)(this,t),this.ctx=void 0,this.scene=void 0,this.showGrid=void 0,this._zoom=void 0,this._translation=void 0,this._rotation=void 0,this._pixelRatio=void 0,this._totalTranslation=void 0,this._tileSize=void 0;var o=e.getContext("2d");if(!o)throw new Error("can not aquire canvas context.");this.ctx=o,this.scene=i,this.showGrid=!0,this._zoom=1,this._translation={x:0,y:0},this._rotation=0,this._pixelRatio=n,this._totalTranslation={x:this.ctx.canvas.width/2+this._translation.x,y:this.ctx.canvas.height/2+this._translation.y},this._tileSize=this._zoom*this._pixelRatio}return Object(g.a)(t,[{key:"render",value:function(){var t=this;this.clear(),this.ctx.translate(this._totalTranslation.x,this._totalTranslation.y),this.ctx.rotate(this._rotation),this.showGrid&&this.renderGrid(),Object.values(this.scene.getTiles()).forEach((function(e){t.ctx.fillStyle=e.color;var i=t.getTileRenderRect(e);t.ctx.fillRect(i.x,i.y,i.w,i.h)}))}},{key:"clear",value:function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.fillStyle="#eeeeee",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}},{key:"getTileRenderRect",value:function(t){return{x:t.position.x*this._tileSize,y:-(t.position.y+1)*this._tileSize,w:this._tileSize,h:this._tileSize}}},{key:"renderGrid",value:function(){var t=Math.sqrt(Math.pow(this.ctx.canvas.width,2)+Math.pow(this.ctx.canvas.height,2))/2,e=this.ctx.canvas.width/2-t-t%this._tileSize,i=-e+this.ctx.canvas.width,n=this.ctx.canvas.height/2-t-t%this._tileSize,o=-n+this.ctx.canvas.height;e-=this._totalTranslation.x-this._translation.x%this._tileSize,i-=this._totalTranslation.x-this._translation.x%this._tileSize,n-=this._totalTranslation.y-this._translation.y%this._tileSize,o-=this._totalTranslation.y-this._translation.y%this._tileSize;var s=this.ctx;s.strokeStyle="#111111";var a=(n+o)/2;g(e,a,i,a);for(var r=1;a+r*this._tileSize<o;r++){var h=a+r*this._tileSize,l=a-r*this._tileSize;g(e,h,i,h),g(e,l,i,l)}var c=(e+i)/2;g(c,n,c,o);for(var d=1;c+d*this._tileSize<i;d++){var u=c+d*this._tileSize,v=c-d*this._tileSize;g(u,n,u,o),g(v,n,v,o)}function g(t,e,i,n){s.beginPath(),s.moveTo(t,e),s.lineTo(i,n),s.stroke()}}},{key:"zoom",get:function(){return this._zoom},set:function(t){this._zoom=t,this._tileSize=this._zoom*this._pixelRatio}},{key:"translation",get:function(){return this._translation},set:function(t){this._translation=t,this._totalTranslation={x:this.ctx.canvas.width/2+this._translation.x,y:this.ctx.canvas.height/2+this._translation.y}}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t}},{key:"pixelRatio",get:function(){return this._pixelRatio},set:function(t){this._pixelRatio=t,this._tileSize=this._zoom*this._pixelRatio}}]),t}(),m=function(){function t(e){var i=this;Object(v.a)(this,t),this.renderer=void 0,this.leftDragging=void 0,this.rightDragging=void 0,this.handleWheel=function(t){i.renderer.zoom+=t.deltaY>0?-.1:.1,i.renderer.zoom=i.renderer.zoom<.1?.1:i.renderer.zoom},this.handleMouseDown=function(t){0===t.button?i.leftDragging=!0:2===t.button&&(i.rightDragging=!0)},this.handleMouseUp=function(t){0===t.button?i.leftDragging=!1:2===t.button&&(i.rightDragging=!1)},this.handleMouseLeave=function(){i.leftDragging=!1,i.rightDragging=!1},this.handleMouseMove=function(t){if(i.leftDragging)i.renderer.translation={x:i.renderer.translation.x+t.movementX,y:i.renderer.translation.y+t.movementY};else if(i.rightDragging){var e=-t.movementX/i.renderer.ctx.canvas.width*180,n=(i.renderer.rotation/Math.PI*180+e)%360;i.renderer.rotation=n/180*Math.PI}},this.handleContextMenu=function(t){t.preventDefault()},this.renderer=e,this.leftDragging=!1,this.rightDragging=!1}return Object(g.a)(t,[{key:"register",value:function(){var t=this.renderer.ctx.canvas;t.addEventListener("wheel",this.handleWheel),t.addEventListener("mousedown",this.handleMouseDown),t.addEventListener("mouseup",this.handleMouseUp),t.addEventListener("mouseleave",this.handleMouseLeave),t.addEventListener("mousemove",this.handleMouseMove),t.addEventListener("contextmenu",this.handleContextMenu)}},{key:"unregister",value:function(){var t=this.renderer.ctx.canvas;t.removeEventListener("wheel",this.handleWheel),t.removeEventListener("mousedown",this.handleMouseDown),t.removeEventListener("mouseup",this.handleMouseUp),t.removeEventListener("mouseleave",this.handleMouseLeave),t.removeEventListener("mousemove",this.handleMouseMove),t.removeEventListener("contextmenu",this.handleContextMenu)}}]),t}(),w=function(){var t=Object(n.useRef)(null),e=Object(n.useState)({width:window.innerWidth,height:window.innerHeight}),i=Object(r.a)(e,2),s=i[0],a=i[1];return window.addEventListener("resize",l.a.debounce((function(){a({width:window.innerWidth,height:window.innerHeight})}),100)),Object(n.useEffect)((function(){if(t.current){for(var e=new f,i=-5;i<5;i++)e.addTile(new _({x:i,y:0,z:0},"rgb(".concat(255*Math.random(),", ").concat(255*Math.random(),", ").concat(255*Math.random(),")")));var n=new x(t.current,e,50),o=new m(n);o.register();var s=!0;return function t(){s&&(n.render(),requestAnimationFrame(t))}(),function(){s=!1,o.unregister()}}}),[]),o.a.createElement("div",{className:u.a.App},o.a.createElement(c,{width:s.width,height:s.height,ref:t}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},6:function(t,e,i){t.exports={App:"App_App__23ZhI"}},8:function(t,e,i){t.exports=i(16)}},[[8,1,2]]]);
//# sourceMappingURL=main.bec62b40.chunk.js.map